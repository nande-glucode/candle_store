<!-- app/views/admin/products/edit.html.erb -->
<div class="min-h-screen bg-gradient-to-br from-nude-100 to-cream-200 py-8">
  <div class="max-w-2xl mx-auto px-4 sm:px-6 lg:px-8">
    <!-- Header with navigation -->
    <div class="flex justify-between items-center mb-8">
      <div>
        <h1 class="text-3xl font-bold text-brown-800">Edit Product</h1>
        <p class="text-brown-600"><%= @product.name %></p>
      </div>
      
      <div class="flex space-x-3">
        <%= link_to "Manage Images", manage_images_admin_product_path(@product), 
            class: "bg-brown-600 text-cream-100 hover:bg-brown-700 px-4 py-2 rounded-lg font-medium transition-colors duration-200" %>
        
        <%= link_to "View Product", admin_product_path(@product), 
            class: "bg-brown-200 text-brown-800 hover:bg-brown-300 px-4 py-2 rounded-lg font-medium transition-colors duration-200" %>
        
        <%= link_to "Back to Products", admin_products_path, 
            class: "bg-nude-200 text-brown-700 hover:bg-nude-300 px-4 py-2 rounded-lg font-medium transition-colors duration-200" %>
      </div>
    </div>

    <!-- Main Edit Form -->
    <div class="bg-cream-100/80 backdrop-blur-sm rounded-xl shadow-lg border border-brown-200">
      <div class="p-8">
        <%= form_with model: [:admin, @product], local: true, class: "space-y-6" do |f| %>
          
          <!-- Error Messages -->
          <% if @product.errors.any? %>
            <div class="bg-red-50 border-2 border-red-200 rounded-lg p-4">
              <div class="flex">
                <div class="text-red-800">
                  <h3 class="text-sm font-semibold">Please fix the following errors:</h3>
                  <ul class="mt-2 text-sm list-disc list-inside space-y-1">
                    <% @product.errors.full_messages.each do |message| %>
                      <li><%= message %></li>
                    <% end %>
                  </ul>
                </div>
              </div>
            </div>
          <% end %>

          <!-- Product Name -->
          <div>
            <%= f.label :name, class: "block text-sm font-semibold text-brown-800 mb-2" %>
            <%= f.text_field :name, 
                class: "w-full px-4 py-3 bg-white border-2 border-brown-300 rounded-lg focus:border-brown-600 focus:ring-2 focus:ring-brown-200 focus:outline-none transition-all duration-200 text-brown-900",
                placeholder: "Enter product name" %>
          </div>

          <!-- Description -->
          <div>
            <%= f.label :description, class: "block text-sm font-semibold text-brown-800 mb-2" %>
            <%= f.text_area :description, rows: 4,
                class: "w-full px-4 py-3 bg-white border-2 border-brown-300 rounded-lg focus:border-brown-600 focus:ring-2 focus:ring-brown-200 focus:outline-none transition-all duration-200 text-brown-900 resize-none",
                placeholder: "Describe your candle's scent, materials, and special features" %>
          </div>

          <!-- Price and Category Row -->
          <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
            <!-- Price -->
            <div>
              <%= f.label :price, class: "block text-sm font-semibold text-brown-800 mb-2" %>
              <div class="relative">
                <span class="absolute left-3 top-1/2 transform -translate-y-1/2 text-brown-600 font-medium">R</span>
                <%= f.number_field :price, step: 0.01, min: 0,
                    class: "w-full pl-8 pr-4 py-3 bg-white border-2 border-brown-300 rounded-lg focus:border-brown-600 focus:ring-2 focus:ring-brown-200 focus:outline-none transition-all duration-200 text-brown-900",
                    placeholder: "0.00" %>
              </div>
            </div>

            <!-- Category -->
            <div>
              <%= f.label :category, class: "block text-sm font-semibold text-brown-800 mb-2" %>
              <%= f.select :category, 
                  options_for_select([
                    ['Coffee Collection', 'coffee collection'],
                    ['Spring Has Sprung Collection', 'spring has sprung collection'],
                    ['Dessert Collection', 'dessert collection']
                  ], @product.category),
                  { prompt: 'Select a category' },
                  { class: "w-full px-4 py-3 bg-white border-2 border-brown-300 rounded-lg focus:border-brown-600 focus:ring-2 focus:ring-brown-200 focus:outline-none transition-all duration-200 text-brown-900" } %>
            </div>
          </div>

          <!-- Stock and Featured Row -->
          <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
            <!-- Stock Quantity -->
            <div>
              <%= f.label :stock_quantity, "Stock Quantity", class: "block text-sm font-semibold text-brown-800 mb-2" %>
              <%= f.number_field :stock_quantity, min: 0,
                  class: "w-full px-4 py-3 bg-white border-2 border-brown-300 rounded-lg focus:border-brown-600 focus:ring-2 focus:ring-brown-200 focus:outline-none transition-all duration-200 text-brown-900",
                  placeholder: "0" %>
            </div>

            <!-- Featured Toggle -->
            <div class="flex items-end pb-3">
              <div class="flex items-center">
                <%= f.check_box :featured, 
                    class: "h-5 w-5 text-brown-600 border-2 border-brown-300 rounded focus:ring-brown-200 focus:ring-2" %>
                <%= f.label :featured, "Featured Product", class: "ml-3 text-sm font-semibold text-brown-800" %>
              </div>
            </div>
          </div>

          <!-- Current Images Preview -->
          <% if @product.images.attached? %>
            <div>
              <h3 class="text-sm font-semibold text-brown-800 mb-3">Current Images</h3>
              <div class="grid grid-cols-2 md:grid-cols-3 gap-4">
                <% @product.images.each do |image| %>
                  <div class="relative group">
                    <div class="aspect-square bg-gradient-to-br from-nude-50 to-cream-100 rounded-lg overflow-hidden border-2 border-brown-200">
                      <%= image_tag image, 
                          class: "h-full w-full object-cover group-hover:scale-105 transition-transform duration-200" %>
                    </div>
                    <div class="absolute top-2 right-2">
                      <span class="bg-brown-600 text-cream-100 text-xs px-2 py-1 rounded-full">
                        <%= image == @product.images.first ? "Primary" : "Gallery" %>
                      </span>
                    </div>
                  </div>
                <% end %>
              </div>
              <div class="mt-4">
                <%= link_to "Manage Images", manage_images_admin_product_path(@product),
                    class: "inline-flex items-center text-sm text-brown-600 hover:text-brown-800 font-medium" %>
              </div>
            </div>
          <% end %>

          <!-- Form Actions -->
          <div class="flex flex-col sm:flex-row gap-4 pt-6 border-t border-brown-200">
            <div class="flex-1 flex space-x-4">
              <%= f.submit "Update Product", 
                  class: "flex-1 bg-brown-700 text-cream-100 hover:bg-brown-800 focus:ring-4 focus:ring-brown-300 px-6 py-3 rounded-lg font-semibold transition-all duration-200 cursor-pointer" %>
              
              <%= link_to "Cancel", admin_product_path(@product), 
                  class: "flex-1 text-center bg-brown-200 text-brown-800 hover:bg-brown-300 focus:ring-4 focus:ring-brown-100 px-6 py-3 rounded-lg font-semibold transition-all duration-200" %>
            </div>
            
            <div class="flex space-x-4">
              <%= link_to "Manage Images", manage_images_admin_product_path(@product), 
                  class: "bg-brown-600 text-cream-100 hover:bg-brown-700 focus:ring-4 focus:ring-brown-300 px-6 py-3 rounded-lg font-medium transition-all duration-200" %>
              
              <%= link_to "Delete Product", admin_product_path(@product), 
                  method: :delete,
                  data: { 
                    confirm: "Are you sure you want to delete this product? This action cannot be undone.",
                    turbo_method: :delete
                  },
                  class: "bg-red-600 text-white hover:bg-red-700 focus:ring-4 focus:ring-red-300 px-6 py-3 rounded-lg font-medium transition-all duration-200" %>
            </div>
          </div>

        <% end %>
      </div>
    </div>

    <!-- Quick Actions Card -->
    <div class="mt-8 bg-cream-100/60 backdrop-blur-sm rounded-xl border border-brown-200 p-6">
      <h3 class="text-lg font-semibold text-brown-800 mb-4">Quick Actions</h3>
      <div class="grid grid-cols-1 sm:grid-cols-3 gap-4">
        <%= link_to admin_product_path(@product), 
            class: "flex items-center justify-center p-4 bg-brown-100 hover:bg-brown-200 rounded-lg transition-colors duration-200 group" do %>
          <div class="text-center">
            <div class="text-brown-700 font-medium">View Product</div>
            <div class="text-brown-600 text-sm mt-1">See public view</div>
          </div>
        <% end %>

        <%= link_to manage_images_admin_product_path(@product), 
            class: "flex items-center justify-center p-4 bg-brown-100 hover:bg-brown-200 rounded-lg transition-colors duration-200 group" do %>
          <div class="text-center">
            <div class="text-brown-700 font-medium">Manage Images</div>
            <div class="text-brown-600 text-sm mt-1"><%= @product.images.count %> images</div>
          </div>
        <% end %>

        <%= link_to admin_products_path, 
            class: "flex items-center justify-center p-4 bg-brown-100 hover:bg-brown-200 rounded-lg transition-colors duration-200 group" do %>
          <div class="text-center">
            <div class="text-brown-700 font-medium">All Products</div>
            <div class="text-brown-600 text-sm mt-1">Back to list</div>
          </div>
        <% end %>
      </div>
    </div>
  </div>
</div>